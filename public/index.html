<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dicey ‚Äî Dice distribution calculator and roller</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="D12.svg">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@ruby/3.4-wasm-wasi@2.7.2/dist/ruby+stdlib.wasm"
        as="fetch" crossorigin="anonymous">
    <link rel="preload" href="main.rb" type="text/ruby" as="fetch" crossorigin="anonymous">
    <link rel="preload" href="dicey.pack.rb" type="text/ruby" as="fetch" crossorigin="anonymous">
    <link rel="preload" href="vector_number.pack.rb" type="text/ruby" as="fetch" crossorigin="anonymous">
</head>

<body>
    <noscript>
        <p>JavaScript is required to use this calculator. Sad but true.</p>
    </noscript>

    <div class="loader" id="loader" popover="manual">
        <div class="loader-spinner">&nbsp;</div>
        <script>
            document.getElementById("loader").showPopover();
        </script>
    </div>

    <div class="container">
        <header class="surface">
            <h1>Dicey</h1>
            <p>Dice distribution calculator and roller</p>
        </header>

        <div class="dice-selection surface">
            <div class="common-dice">
                <h2>Common dice</h2>
                <div class="dice-grid">
                    <button class="dice-button" data-die="D4" id="die-d4">
                        <svg viewBox="-10 -10 120 120">
                            <polygon points="50,10 100,90 30,100 0,85" />
                            <line x1="50" y1="10" x2="30" y2="100" />
                        </svg>
                        <span>D4</span>
                    </button>
                    <button class="dice-button" data-die="D6" id="die-d6">
                        <svg viewBox="-10 -10 120 120">
                            <polygon points="0,20 60,15 100,20 100,90 40,100 0,90" />
                            <polyline points="0,20 40,25 100,20" />
                            <polyline points="40,25 40,100" />
                        </svg>
                        <span>D6</span>
                    </button>
                    <button class="dice-button" data-die="D8" id="die-d8">
                        <svg viewBox="-10 -10 120 120">
                            <polygon points="50,0 0,50 50,100 100,55" />
                            <polyline points="0,50 25,60 100,55" />
                            <polyline points="50,0 25,60 50,100" />
                        </svg>
                        <span>D8</span>
                    </button>
                    <button class="dice-button" data-die="D10" id="die-d10">
                        <svg viewBox="-10 -10 120 120">
                            <polygon points="50,0 95,40 95,55 50,95 5,55 5,40" />
                            <polyline points="5,55 25,45 50,60 75,45 95,55" />
                            <line x1="50" y1="0" x2="25" y2="45" />
                            <line x1="50" y1="0" x2="75" y2="45" />
                            <line x1="50" y1="95" x2="50" y2="60" />
                        </svg>
                        <span>D10</span>
                    </button>
                    <button class="dice-button" data-die="D12" id="die-d12">
                        <svg viewBox="-10 -10 120 120">
                            <polygon points="50,0 80,5 100,40 95,65 80,90 50,100 20,90 5,65 0,40 20,5" />
                            <polyline points="5,65 25,55 50,70 75,55 95,65" />
                            <polyline points="20,5 35,15 65,15 80,5" />
                            <line x1="35" y1="15" x2="25" y2="55" />
                            <line x1="65" y1="15" x2="75" y2="55" />
                            <line x1="50" y1="70" x2="50" y2="100" />
                        </svg>
                        <span>D12</span>
                    </button>
                    <button class="dice-button" data-die="D20" id="die-d20">
                        <svg viewBox="-10 -10 120 120">
                            <polygon points="50,0 95,20 95,75 50,100 5,75 5,20" />
                            <polyline points="5,20 25,35 75,35 95,20" />
                            <polyline points="5,75 25,35 50,80 75,35 95,75" />
                            <polyline points="5,75 50,80 95,75" />
                            <line x1="50" y1="0" x2="25" y2="35" />
                            <line x1="50" y1="0" x2="75" y2="35" />
                            <line x1="50" y1="80" x2="50" y2="100" />
                        </svg>
                        <span>D20</span>
                    </button>
                    <button class="dice-button" data-die="üêµ,üêí" id="die-coin">
                        <svg viewBox="-10 -10 120 120">
                            <ellipse cx="50" cy="65" rx="50" ry="30" />
                            <ellipse cx="50" cy="55" rx="50" ry="30" />
                            <text x="48" y="60" rotate="15">üêµ</text>
                        </svg>
                        <span>Coin</span>
                    </button>
                    <button class="dice-button" data-die="üëë,‚ô†Ô∏è,‚ô•Ô∏è,‚ô£Ô∏è,‚ô¶Ô∏è,‚öìÔ∏è" id="die-crown-anchor">
                        <svg viewBox="-10 -10 120 120">
                            <polygon points="0,20 60,15 100,20 100,90 40,100 0,90" />
                            <polyline points="0,20 40,25 100,20" />
                            <polyline points="40,25 40,100" />
                            <text x="70" y="70" rotate="-6" lengthAdjust="spacingAndGlyphs" textLength="30">‚ô•Ô∏è</text>
                            <text x="20" y="65" rotate="6" lengthAdjust="spacingAndGlyphs" textLength="20">‚ô†Ô∏è</text>
                        </svg>
                        <span>üëë&‚öì</span>
                    </button>
                </div>
            </div>

            <div class="custom-dice">
                <h2>Custom dice</h2>
                <form action="javascript:void(0);" id="custom-dice-form">
                    <label for="custom-dice-input">Add a custom die:</label>
                    <div class="input-group">
                        <input type="text" placeholder="e.g. d3, -4..4, or 2,3,11,2" id="custom-dice-input"
                            pattern="\s*[Dd]?([1-9][0-9]*|\(?-?[1-9][0-9]*(-|..|...|‚Äì|‚Äî|‚Ä¶)-?[1-9][0-9]*\)?|\(?-?[0-9]+((,-?[0-9]+)+|,)\)?|\(?[^'&quot;\(\),]+((,[^'&quot;\(\),]+)+|,)\)?)\s*"
                            enterkeyhint="done" oninput="(e) => e.target.checkValidity()">
                        <button class="standout-button" id="custom-dice-button">Add</button>
                    </div>
                </form>
            </div>

            <div class="selected-dice">
                <h2>Selected dice</h2>
                <div class="dice-list" id="selected-dice-list"></div>
            </div>
        </div>

        <div class="roll-results surface">
            <h2>Roll results</h2>
            <div class="roll-output" id="roll-output"></div>
            <button class="standout-button reroll-button" id="reroll-button">Reroll</button>
        </div>

        <div class="distribution-results surface">
            <h2>Probability distribution</h2>
            <table id="results-table">
                <thead>
                    <tr>
                        <th><span title="Total value of all dice, also known as outcome">Value</span></th>
                        <th><span title="Number of distinct rolls that can produce this outcome">Weight</span></th>
                        <th><span title="Probability of this outcome">P</span></th>
                        <th><span title="Probability of this outcome relative to probability of most likely outcome">P/Mode</span></th>
                    </tr>
                </thead>
                <tbody id="results-table-body"></tbody>
            </table>
            <div id="empty-results-table">
                <p><i>Here be probabilities!</i></p>
                <p>But currently they aren't.</p>
            </div>
        </div>

        <footer class="surface">
            <nav>
                <p><b>Dicey</b> is brought to you by <a href="https://bulancov.pro">Alexander&nbsp;Bulancov</a>.</p>
                <p>See <a href="https://github.com/trinistr/dicey">Dicey's GitHub repository</a> for the underlying Ruby gem and <a href="https://github.com/trinistr/dicey.bulancov.tech">this webapp's repository</a> to see how it works in the browser. Suggestions are welcome!</p>
            </nav>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@ruby/3.4-wasm-wasi@2.7.2/dist/browser.script.iife.js"></script>
    <script src="main.rb" type="text/ruby" data-eval="async"></script>
</body>

</html>
